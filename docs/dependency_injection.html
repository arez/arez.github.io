<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Dependency Injection · Arez</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Dependency Injection · Arez"/><meta property="og:type" content="website"/><meta property="og:url" content="https://arez.github.io/index.html"/><meta property="og:description" content="Arez components provide several different mechanisms for integrating into dependency injection"/><link rel="shortcut icon" href="/img/favicon-32x32.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/idea.min.css"/><link rel="alternate" type="application/atom+xml" href="https://arez.github.io/blog/atom.xml" title="Arez Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://arez.github.io/blog/feed.xml" title="Arez Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.svg"/><h2 class="headerTitle">Arez</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/docs/overview.html" target="_self">Docs</a></li><li><a href="/api" target="_self">API</a></li><li><a href="/blog" target="_self">Blog</a></li><li><a href="https://github.com/arez/arez/releases" target="_blank">Releases</a></li><li><a href="https://github.com/arez/arez" target="_blank">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Components</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>About</h3><ul><li class="navListItem"><a class="navItem" href="/docs/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/motivation.html">Motivation</a></li><li class="navListItem"><a class="navItem" href="/docs/project_setup.html">Project Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/getting_started.html">Getting Started</a></li></ul></div><div class="navGroup navGroupActive"><h3>Concepts</h3><ul><li class="navListItem"><a class="navItem" href="/docs/concepts.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/transactions.html">Transactions</a></li><li class="navListItem"><a class="navItem" href="/docs/observables.html">Observables</a></li><li class="navListItem"><a class="navItem" href="/docs/computed_values.html">Computed Values</a></li><li class="navListItem"><a class="navItem" href="/docs/observers.html">Observers</a></li><li class="navListItem"><a class="navItem" href="/docs/actions.html">Actions</a></li><li class="navListItem"><a class="navItem" href="/docs/scheduler.html">Scheduler</a></li><li class="navListItem"><a class="navItem" href="/docs/native_components.html">Native Components</a></li><li class="navListItem"><a class="navItem" href="/docs/zones.html">Zones</a></li></ul></div><div class="navGroup navGroupActive"><h3>Components</h3><ul><li class="navListItem"><a class="navItem" href="/docs/components.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/component_example.html">Example</a></li><li class="navListItem"><a class="navItem" href="/docs/at_arez_component.html">@ArezComponent</a></li><li class="navListItem"><a class="navItem" href="/docs/at_component_id.html">@ComponentId</a></li><li class="navListItem"><a class="navItem" href="/docs/lifecycle_callbacks.html">Lifecycle Callbacks</a></li><li class="navListItem"><a class="navItem" href="/docs/at_observable.html">@Observable</a></li><li class="navListItem"><a class="navItem" href="/docs/at_computed.html">@Computed</a></li><li class="navListItem"><a class="navItem" href="/docs/at_memoize.html">@Memoize</a></li><li class="navListItem"><a class="navItem" href="/docs/at_action.html">@Action</a></li><li class="navListItem"><a class="navItem" href="/docs/at_autorun.html">@Autorun</a></li><li class="navListItem"><a class="navItem" href="/docs/at_track.html">@Track</a></li><li class="navListItem"><a class="navItem" href="/docs/at_dependency.html">@Dependency</a></li><li class="navListItem"><a class="navItem" href="/docs/repositories.html">Repositories</a></li><li class="navListItem"><a class="navItem" href="/docs/generated_classes.html">Generated Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/accessing_primitives.html">Accessing primitives</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/dependency_injection.html">Dependency Injection</a></li></ul></div><div class="navGroup navGroupActive"><h3>Project Documentation</h3><ul><li class="navListItem"><a class="navItem" href="/docs/faq.html">Frequently Asked Questions</a></li><li class="navListItem"><a class="navItem" href="/docs/related_projects.html">Related projects</a></li><li class="navListItem"><a class="navItem" href="/docs/development_process.html">Development Process</a></li><li class="navListItem"><a class="navItem" href="/docs/intellij.html">IntelliJ IDEA IDE Setup</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/arez/arez/tree/master/docs/dependency_injection.md" target="_blank">Edit</a><h1>Dependency Injection</h1></header><article><div><span><p>Arez components provide several different mechanisms for integrating into dependency injection
frameworks. The two dependency injection frameworks that have seen the most use are
<a href="https://google.github.io/dagger">Dagger2</a> and <a href="https://code.google.com/archive/p/google-gin/">GIN</a>.
This is due to Arez being primarily used within a web browser context.</p>
<p>Arez components typically consist of the base component (i.e. <code>com.example.MyComponent</code>), the enhanced
component class generated by the Arez annotation processor (i.e. <code>com.example.Arez_MyComponent</code>)
and optionally a generated base repository (i.e. <code>com.example.MyComponentRepository</code>) and an enhanced
repository class (i.e. <code>com.example.Arez_MyComponentRepository</code>) both of which are generated by
the annotation processor.</p>
<p>Typically when using Arez component in an application that uses dependency injection, the consuming
code will use <code>@Inject</code> to get references to the base component (i.e. <code>com.example.MyComponent</code>) or
the base repository (i.e. <code>com.example.MyComponentRepository</code>). The consumer code ends up looking
something like one of the following examples depending on whether constructor based injection is used.</p>
<p><pre><code class="hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExampleConsumer</span>
</span>{
  <span class="hljs-meta">@Inject</span>
  MyService _myService;
  <span class="hljs-meta">@Inject</span>
  MyEntityRepository _repository;

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">performSomeAction</span><span class="hljs-params">()</span>
  </span>{
    _repository.findAll().forEach( e -&gt; {
      _myService.performAction( e.getValue() );
    } );
  }
}</code></pre></p>
<p><pre><code class="hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExampleConsumer</span>
</span>{
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> MyService _myService;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> MyEntityRepository _repository;

  <span class="hljs-meta">@Inject</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExampleConsumer</span><span class="hljs-params">( <span class="hljs-keyword">final</span> MyService myService, <span class="hljs-keyword">final</span> MyEntityRepository repository )</span>
  </span>{
    _myService = myService;
    _repository = repository;
  }

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">performSomeAction</span><span class="hljs-params">()</span>
  </span>{
    _repository.findAll().forEach( e -&gt; {
      _myService.performAction( e.getValue() );
    } );
  }
}</code></pre></p>
<p>In both scenarios the <code>ExampleConsumer</code> class needs to be injected with two separate dependencies; <code>MyService</code>
and <code>MyEntityRepository</code>. Every injection framework uses a slightly different mechanism to determine how to
construct and wire together a graph of objects however a common strategy is to add an <code>@Inject</code> annotation to
a single constructor for the type to be injected. Within the context of Arez this means annotating a constructor
in the enhanced classes (i.e. <code>com.example.Arez_MyComponent</code> and <code>com.example.Arez_MyComponentRepository</code>).</p>
<p>Arez will add the <code>@Inject</code> annotation to the constructor of the enhanced component if the <code>inject</code> parameter
on the <code>@ArezComponent</code> is set to <code>ENABLE</code>. If the <code>inject</code> parameter is <code>AUTODETECT</code> and the base component is
annotated with a &quot;scope&quot; annotation then Arez will annotate the enhanced subclass with the same scope annotation
and add an <code>@Inject</code> annotation to the constructor.</p>
<p>The <a href="/api/arez/annotations/Repository.html"><code>@Repository</code></a> annotation has a similar <code>inject</code> parameter and the base repository will
be automatically annotated with the <code>@javax.inject.Singleton</code> scope annotation if the <code>javax.inject.Inject</code> class
is present.</p>
<p>This would be sufficient if the consumer code always consumed the enhanced classes but as this is rarely the
case, each injection framework has mechanisms that allow the framework to supply an instance of the enhanced
sub-class when the base class is requested. The way this is done is framework specific and is covered in the
following sections.</p>
<h2><a class="anchor" aria-hidden="true" name="gin"></a><a href="#gin" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GIN</h2>
<p><a href="https://code.google.com/archive/p/google-gin/">GIN</a> is a extension of Guice 3.0 that runs under GWT. The root
objects in the object graph are accessed via a <code>Ginjector</code> and the injection rules can be customized by
supplying <code>GinModule</code> classes to the <code>Ginjector</code>. A <code>GinModule</code> that would expose the base classes in the
injection the framework is as simple as:</p>
<p><pre><code class="hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExampleGinModule</span>
  <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractGinModule</span>
</span>{
  <span class="hljs-meta">@Override</span>
  <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">()</span>
  </span>{
    bind( MyService.class ).to( Arez_MyService.class ).asEagerSingleton();
    bind( MyEntityRepository.class ).to( Arez_MyEntityRepository.class ).asEagerSingleton();
  }
}</code></pre></p>
<p>Which could be linked up to a <code>Ginjector</code> like:</p>
<p><pre><code class="hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ExampleGinjector</span>
  <span class="hljs-keyword">extends</span> <span class="hljs-title">Ginjector</span>
</span>{
  <span class="hljs-function">ExampleConsumer <span class="hljs-title">getExampleConsumer</span><span class="hljs-params">()</span></span>;
}</code></pre></p>
<p>And used in code like:</p>
<p><pre><code class="hljs"><span class="hljs-keyword">final</span> ExampleGinjector injector = GWT.create( ExampleGinjector.class );
injector.getExampleConsumer().performSomeAction();</code></pre></p>
<p>Gin was the injection framework of choice for GWT applications for a very long time and thus is present in
many existing GWT applications. However it is no longer under active development, has problems in modern
JVMs and is unlikely to be supported in GWT3.x so it's use is not recommended for modern GWT applications.</p>
<h2><a class="anchor" aria-hidden="true" name="dagger2"></a><a href="#dagger2" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dagger2</h2>
<p><a href="https://google.github.io/dagger">Dagger2</a> is a modern take on a dependency injection framework that uses annotation
processors and statically checks the object graph at compilation time. The root objects in the graph are accessed via
a component which is an interface annotated by the <code>@dagger.Component</code> annotation. The injection rules are customized
via <code>@dagger.Module</code> annotated classes.</p>
<p>Arez has greater support for the dagger injection framework than GIN. The <a href="/api/arez/annotations/ArezComponent.html"><code>@ArezComponent</code></a>
and <a href="/api/arez/annotations/Repository.html"><code>@Repository</code></a> annotations have a <code>dagger</code> parameter that controls whether the Arez
annotation processor generates dagger modules.</p>
<p>If the value of the <code>dagger</code> parameter is <code>ENABLE</code> or <code>AUTODETECT</code> and the <code>dagger.Component</code> class is on the
classpath then a module will be generated for each base component and base repository that looks like:</p>
<p><pre><code class="hljs"><span class="hljs-meta">@Generated</span>(<span class="hljs-string">"arez.processor.ArezProcessor"</span>)
<span class="hljs-meta">@Module</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">MyServiceDaggerModule</span> </span>{
  <span class="hljs-meta">@Nonnull</span>
  <span class="hljs-meta">@Provides</span>
  <span class="hljs-meta">@Singleton</span>
  <span class="hljs-function"><span class="hljs-keyword">static</span> MyService <span class="hljs-title">provideComponent</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Arez_MyService component)</span> </span>{
    <span class="hljs-keyword">return</span> component;
  }
}</code></pre></p>
<p>These can be incorporated into a dagger component like:</p>
<p><pre><code class="hljs"><span class="hljs-meta">@Singleton</span>
<span class="hljs-meta">@Component</span>( modules = { MyServiceDaggerModule.class, MyEntityRepositoryDaggerModule.class } )
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ExampleDaggerComponent</span>
</span>{
  <span class="hljs-function">ExampleConsumer <span class="hljs-title">getExampleConsumer</span><span class="hljs-params">()</span></span>;
}</code></pre></p>
<p>And used in code like:</p>
<p><pre><code class="hljs"><span class="hljs-keyword">final</span> ExampleDaggerComponent component = DaggerExampleDaggerComponent.create();
component.getExampleConsumer().performSomeAction();</code></pre></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="accessing_primitives.html">← Accessing primitives</a><a class="docs-next button" href="faq.html">Frequently Asked Questions →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo.svg" alt="Arez" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/overview.html">Overview</a><a href="/docs/concepts.html">Concepts</a><a href="/api/index.html">API Reference</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" href="https://github.com/arez/arez" data-icon="octicon-star" data-count-href="/arez/arez/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2018 the Arez Project.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: 'b8c49751e0914443436822868f0c5000',
                indexName: 'arez',
                inputSelector: '#search_input_react'
              });
            </script></body></html>