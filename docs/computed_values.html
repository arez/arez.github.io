<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Computed Values · Arez</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Computed Values · Arez"/><meta property="og:type" content="website"/><meta property="og:url" content="https://arez.github.io/index.html"/><meta property="og:description" content="Computed values are values that can be derived from the existing state or other computed values. Conceptually,"/><link rel="shortcut icon" href="/img/favicon-32x32.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/idea.min.css"/><link rel="alternate" type="application/atom+xml" href="https://arez.github.io/blog/atom.xml" title="Arez Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://arez.github.io/blog/feed.xml" title="Arez Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.svg"/><h2 class="headerTitle">Arez</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/docs/overview.html" target="_self">Docs</a></li><li><a href="/api" target="_self">API</a></li><li><a href="/blog" target="_self">Blog</a></li><li><a href="https://github.com/arez/arez/releases" target="_blank">Releases</a></li><li><a href="https://github.com/arez/arez" target="_blank">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Concepts</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>About</h3><ul><li class="navListItem"><a class="navItem" href="/docs/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/motivation.html">Motivation</a></li><li class="navListItem"><a class="navItem" href="/docs/project_setup.html">Project Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/getting_started.html">Getting Started</a></li></ul></div><div class="navGroup navGroupActive"><h3>Concepts</h3><ul><li class="navListItem"><a class="navItem" href="/docs/concepts.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/transactions.html">Transactions</a></li><li class="navListItem"><a class="navItem" href="/docs/observables.html">Observables</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/computed_values.html">Computed Values</a></li><li class="navListItem"><a class="navItem" href="/docs/observers.html">Observers</a></li><li class="navListItem"><a class="navItem" href="/docs/actions.html">Actions</a></li><li class="navListItem"><a class="navItem" href="/docs/scheduler.html">Scheduler</a></li><li class="navListItem"><a class="navItem" href="/docs/native_components.html">Native Components</a></li><li class="navListItem"><a class="navItem" href="/docs/zones.html">Zones</a></li></ul></div><div class="navGroup navGroupActive"><h3>Components</h3><ul><li class="navListItem"><a class="navItem" href="/docs/components.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/component_example.html">Example</a></li><li class="navListItem"><a class="navItem" href="/docs/at_arez_component.html">@ArezComponent</a></li><li class="navListItem"><a class="navItem" href="/docs/at_component_id.html">@ComponentId</a></li><li class="navListItem"><a class="navItem" href="/docs/lifecycle_callbacks.html">Lifecycle Callbacks</a></li><li class="navListItem"><a class="navItem" href="/docs/at_observable.html">@Observable</a></li><li class="navListItem"><a class="navItem" href="/docs/at_computed.html">@Computed</a></li><li class="navListItem"><a class="navItem" href="/docs/at_memoize.html">@Memoize</a></li><li class="navListItem"><a class="navItem" href="/docs/at_action.html">@Action</a></li><li class="navListItem"><a class="navItem" href="/docs/at_autorun.html">@Autorun</a></li><li class="navListItem"><a class="navItem" href="/docs/at_track.html">@Track</a></li><li class="navListItem"><a class="navItem" href="/docs/at_dependency.html">@Dependency</a></li><li class="navListItem"><a class="navItem" href="/docs/repositories.html">Repositories</a></li><li class="navListItem"><a class="navItem" href="/docs/generated_classes.html">Generated Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/accessing_primitives.html">Accessing primitives</a></li><li class="navListItem"><a class="navItem" href="/docs/dependency_injection.html">Dependency Injection</a></li></ul></div><div class="navGroup navGroupActive"><h3>Project Documentation</h3><ul><li class="navListItem"><a class="navItem" href="/docs/faq.html">Frequently Asked Questions</a></li><li class="navListItem"><a class="navItem" href="/docs/related_projects.html">Related projects</a></li><li class="navListItem"><a class="navItem" href="/docs/development_process.html">Development Process</a></li><li class="navListItem"><a class="navItem" href="/docs/intellij.html">IntelliJ IDEA IDE Setup</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/arez/arez/tree/master/docs/computed_values.md" target="_blank">Edit</a><h1>Computed Values</h1></header><article><div><span><p>Computed values are values that can be derived from the existing state or other computed values. Conceptually,
they are very similar to formulas in spreadsheets. Computed values can't be underestimated, as they help you
to make your actual modifiable state as small as possible. Besides that they are highly optimized, so use
them wherever possible.</p>
<p>Computed values are automatically derived from your state if any value that affects them changes. Computed
values can be optimized away in many cases by Arez as they are assumed to be pure. For example, a computed
property won't re-run if none of the data used in the previous computation changed. Nor will a computed
property re-run if is not in use by some other computed property or observer. In such cases it will be
suspended.</p>
<p>Don't confuse computed values with autorun <a href="/docs/observers.html">observers</a>. They are both reactively invoked
expressions, but use computed values if you want to produce a value that can be used by other observers
or computed values. Use autorun <a href="/docs/observers.html">observers</a> if you don't want to produce a new value but
rather want to achieve an effect such as imperative side effects like logging, making network requests
etc.</p>
<p>This automatic suspension is very convenient. If a computed value is no longer observed, for example the
UI in which it was used no longer exists, then Arez wil no longer recalculate the value. This differs from
autorun observer's values where you must dispose of them yourself.</p>
<p>Within the Arez system a computed value observable is represented by an instance of the <a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a>
class. The <a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a> class contains a cache of the value that is computed and a reference to the
function that computes the value. It provides a method <a href="/api/arez/ComputedValue.html#get--"><code>ComputedValue.get()</code></a> to
access the cached value or recalculate the value if it is stale. The <a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a> contains the necessary
logic required to determine staleness and notify dependencies. Internally it uses instances of <a href="/api/arez/ObservableValue.html"><code>ObservableValue</code></a>
and <a href="/api/arez/Observer.html"><code>Observer</code></a> to achieve this goal.</p>
<p>The <a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a> class is a relatively low-level primitive and users typically use higher level
constructs such as the <a href="/docs/at_computed.html">@Computed</a> annotation.</p>
<h2><a class="anchor" aria-hidden="true" name="callbacks"></a><a href="#callbacks" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Callbacks</h2>
<p>When the computed values is created, several callback can be supplied that allow the developer to customize
behaviour when certain state transitions occur. These callbacks are typically used if the computed value needs
to interact with platform services to keep the computed value up to date. i.e. In a web browser environment, a
computed value may add an event listener to browser objects so that it can invalidate the cached value in response
to events from the browser.</p>
<p>The callbacks are:</p>
<ul>
<li><strong>onActivate</strong>: This callback is invoked when the computed value goes from having no observers to having 1 or
more observers. This callback is often used to subscribe to changes from the native platform.</li>
<li><strong>onDeactivate</strong>: This callback is invoked when the computed value goes from having 1 or more observers to
having no observers. This callback is often used to unsubscribe from changes from the native platform.</li>
<li><strong>onStale</strong>: This callback is invoked when the computed value is stale and needs to be recomputed. This callback
is often used to initiate processes to update the computed value.</li>
<li><strong>onDispose</strong>: This callback is invoked when the computed value is disposed. This callback is used to release
resources (i.e. event listeners) that have been allocated in other callbacks.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" name="equality-comparison"></a><a href="#equality-comparison" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Equality Comparison</h2>
<p>Every time an activated computed value's dependency is marked as stale, the computed value will attempt to
re-computed the computed value. If the computed value is equal to the cached value then the computed value
will be marked as unchanged and no downstream observers or computed values will be scheduled. Equality is
tested using <code>Object.equals(...)</code> method.</p>
<h2><a class="anchor" aria-hidden="true" name="error-handling"></a><a href="#error-handling" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Error Handling</h2>
<p>Exceptions thrown when calculating computed values are caught by the Arez runtime using the same mechanisms that
handle <a href="/docs/observers.html#error-handling">errors</a> in observers. The exception is cached and will be re-thrown if a
transaction attempts to access the computed value.</p>
<h2><a class="anchor" aria-hidden="true" name="non-arez-dependencies"></a><a href="#non-arez-dependencies" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Non-Arez Dependencies</h2>
<p>In some cases a <a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a> can be derived from non-arez dependencies. In these scenarios it is
expected that the developer will need to explicitly track the non-arez dependency and notify the
<a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a> when the dependency has changed by invoking the method
<a href="/api/arez/ComputedValue.html#reportPossiblyChanged--"><code>ComputedValue.reportPossiblyChanged()</code></a>. The <a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a>
will then be marked as possibly changed and will recalculate the value either on next access or when the
Arez scheduler is next invoked. This approach is particularly useful if you are attempting to integrate with
event based systems or event-driven reactive frameworks such as <a href="https://github.com/ReactiveX/RxJava">RxJava</a>.</p>
<p>It should be noted that the <a href="/api/arez/ComputedValue.html#reportPossiblyChanged--"><code>ComputedValue.reportPossiblyChanged()</code></a>
can only be invoked if the <a href="/api/arez/ComputedValue.html"><code>ComputedValue</code></a> was created with the parameter <code>arezOnlyDependencies</code>
set to <code>true</code>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="observables.html">← Observables</a><a class="docs-next button" href="observers.html">Observers →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo.svg" alt="Arez" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/overview.html">Overview</a><a href="/docs/concepts.html">Concepts</a><a href="/api/index.html">API Reference</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" href="https://github.com/arez/arez" data-icon="octicon-star" data-count-href="/arez/arez/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2018 the Arez Project.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: 'b8c49751e0914443436822868f0c5000',
                indexName: 'arez',
                inputSelector: '#search_input_react'
              });
            </script></body></html>